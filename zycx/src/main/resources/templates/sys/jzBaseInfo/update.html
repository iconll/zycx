<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<body>
<form id="jzBaseInfoForm"  role="form" method="post" action="jzBaseInfo/update">
    <div class="row">
        <div class="col-md-12">
            <input type="hidden" name="id"  th:value="${entity.id}" />
            <input type="hidden" name="operater"  th:value="${entity.operater}" />
            <div class="form-group" >
                <label for="applyCode"><span style="color:red;">*</span>申请编码:</label>
                <input type="text" class="form-control" name="applyCode" id="applyCode" th:value="${entity.applyCode}"  placeholder="请输入申请编码" />
            </div>
            <div class="form-group">
                <label for="employeeName"><span style="color:red;">*</span>营销员姓名:</label>
                <input type="text" class="form-control" name="employeeName" id="employeeName" th:value="${entity.employeeName}" placeholder="请输入营销员姓名" />
            </div>
            <div class="form-group">
                <label for="employeeId"><span style="color:red;">*</span>营销员编号:</label>
                <input type="text" class="form-control" name="employeeId" id="employeeId" th:value="${entity.employeeId}" placeholder="请输入营销员编号" />
            </div>
            <div class="form-group">
                <label for="bankInfoId"><span style="color:red;">*</span>网点名称:</label>
                <select name = "bankInfoId" id = "bankInfoId" class="form-control"></select>
            </div>
            <div class="form-group">
                <label for="jjTime">进件时间:</label>
                <input type="text" class="form-control" name="jjTime" id="jjTime" readonly />
            </div>
            <div class="form-group">
                <label for="jjType">进件类型:</label>
                <input type="text" class="form-control" name="jjType" id="jjType" th:value="${entity.jjType}" placeholder="请输入进件类型" />
            </div>
            <div class="form-group">
                <label for="customerName">客户姓名:</label>
                <input type="text" class="form-control" name="customerName" id="customerName" th:value="${entity.customerName}" placeholder="请输入客户姓名" />
            </div>
            <div class="form-group">
                <label for="identityCode">身份证号码:</label>
                <input type="text" class="form-control" name="identityCode" id="identityCode" th:value="${entity.identityCode}" placeholder="请输入身份证号码" />
            </div>
            <div class="form-group">
                <label for="contactNumber">联系电话:</label>
                <input type="text" class="form-control" name="contactNumber" id="contactNumber" th:value="${entity.contactNumber}" placeholder="请输入联系电话" />
            </div>
            <div class="form-group">
                <label for="workCompany">工作单位:</label>
                <input type="text" class="form-control" name="workCompany" id="workCompany" th:value="${entity.workCompany}" placeholder="请输入工作单位" />
            </div>
            <div class="form-group">
                <label for="houseType">房屋性质:</label>
                <input type="text" class="form-control" name="houseType" id="houseType" th:value="${entity.houseType}" placeholder="请输入房屋性质" />
            </div>

            <div class="form-group">
                <label for="jzFqQs">分期期数:</label>
                <input type="text" class="form-control" name="jzFqQs" id="jzFqQs" th:value="${entity.jzFqQs}" placeholder="请输入分期期数" />
            </div>
            <div class="form-group">
                <label for="jzFqRate">费率:</label>
                <input type="text" class="form-control" name="jzFqRate" id="jzFqRate" th:value="${entity.jzFqRate}" placeholder="请输入费率" />
            </div>
            <div class="form-group">
                <label for="jzFqMoney">分期金额:</label>
                <input type="text" class="form-control" name="jzFqMoney" id="jzFqMoney" th:value="${entity.jzFqMoney}" placeholder="请输入分期金额" />
            </div>
            <div class="form-group">
                <label for="jzSpMoney"><span style="color:red;">*</span>审批金额:</label>
                <input type="text" class="form-control" name="jzSpMoney" id="jzSpMoney" th:value="${entity.jzSpMoney}" placeholder="请输入调额金额" />
            </div>
            <div class="form-group">
                <label for="passDate"><span style="color:red;">*</span>通过时间:</label>
                <input type="text" class="form-control" name="passDate" id="passDate"  readonly/>
            </div>
            <div class="form-group">
                <label for="firstTeMoney">一次调额金额:</label>
                <input type="text" class="form-control" name="firstTeMoney" id="firstTeMoney" th:value="${entity.firstTeMoney}"/>
            </div>
            <div class="form-group">
                <label for="firstTeTime">一次调额时间:</label>
                <input type="text" class="form-control" name="firstTeTime" id="firstTeTime"  placeholder="请选择一次调额时间" readonly/>
            </div>
            <div class="form-group">
                <label for="firstZyFlag">一次调额支用标识:</label>
                <input type="text" class="form-control" name="firstZyFlag" id="firstZyFlag" th:value="${entity.firstZyFlag}"/>
            </div>

            <div class="form-group">
                <label for="secondTeMoney">二次调额金额:</label>
                <input type="text" class="form-control" name="secondTeMoney" id="secondTeMoney" th:value="${entity.secondTeMoney}"/>
            </div>
            <div class="form-group">
                <label for="secondTeTime">二次调额时间:</label>
                <input type="text" class="form-control" name="secondTeTime" id="secondTeTime"  placeholder="请选择二次调额时间" readonly/>
            </div>
            <div class="form-group">
                <label for="secondZyFlag">二次调额支用标识:</label>
                <input type="text" class="form-control" name="secondZyFlag" id="secondZyFlag" th:value="${entity.secondZyFlag}"/>
            </div>
            <div class="form-group">
                <label for="surplusMoney">剩余可用额度:</label>
                <input type="text" class="form-control" name="surplusMoney" id="surplusMoney" th:value="${entity.surplusMoney}"  placeholder="请输入剩余可用额度"/>
            </div>
            <div class="form-group">
                <label for="edEndTime">额度失效时间:</label>
                <input type="text" class="form-control" name="edEndTime" id="edEndTime" placeholder="请选择额度失效时间" readonly/>
            </div>
            <div class="form-group">
                <label for="cardNumber">卡号:</label>
                <input type="text" class="form-control" name="cardNumber" id="cardNumber" th:value="${entity.cardNumber}" placeholder="请输入卡号" />
            </div>

            <div class="form-group">
                <label for="governor">主管:</label>
                <input type="text" class="form-control" name="governor" id="governor" th:value="${entity.governor}" placeholder="请输入主管" />
            </div>
            <div class="form-group">
                <label for="acceptorg">受理机构:</label>
                <input type="text" class="form-control" name="acceptorg" id="acceptorg" th:value="${entity.acceptorg}" placeholder="请输入受理机构" />
            </div>
            <div class="form-group">
                <label for="yxqd">营销机构:</label>
                <input type="text" class="form-control" name="yxqd" id="yxqd" th:value="${entity.yxqd}" placeholder="请输入营销机构" />
            </div>
            <div class="form-group">
                <label for="isGd">是否归档:</label>
                <input type="text" class="form-control" name="isGd" id="isGd" th:value="${entity.isGd}" placeholder="请输入是否归档" />
            </div>
            <div class="form-group">
                <label for="guidangDate">归档时间:</label>
                <input type="text" class="form-control" name="guidangDate" id="guidangDate" placeholder="请选择归档时间" readonly/>
            </div>
        </div>
    </div>
</form>
<script th:inline="javascript">
    <![CDATA[
    $(function () {
        //回显日期
        setDateValue("jjTime",[[${entity.jjTime}]]);
        setDateValue("passDate",[[${entity.passDate}]]);
        setDateValue("firstTeTime",[[${entity.firstTeTime}]]);
        setDateValue("secondTeTime",[[${entity.secondTeTime}]]);
        setDateValue("edEndTime",[[${entity.edEndTime}]]);
        setDateValue("guidangDate",[[${entity.guidangDate}]]);

        //加载网点信息下拉框
        loadBankInfoSelectOption("bankInfoId",[[${entity.bankInfoId}]]);
        //加载日期选择框
        loadDatetimepicker("jjTime");
        loadDatetimepicker("passDate");
        loadDatetimepicker("firstTeTime");
        loadDatetimepicker("secondTeTime");
        loadDatetimepicker("edEndTime");
        loadDatetimepicker("guidangDate");

        //表单项校验
        $('#jzBaseInfoForm').bootstrapValidator({
            message: 'This value is not valid',
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                applyCode: {
                    message: '申请编码验证失败',
                    validators: {
                        notEmpty: {
                            message: '申请编码不能为空'
                        } ,
                        stringLength: {
                            min: 2,
                            max: 30,
                            message: '申请编码长度必须在2到30之间'
                        },
                        threshold :  6 , //有6字符以上才发送ajax请求，（input中输入一个字符，插件会向服务器发送一次，设置限制，6字符以上才开始）
                        remote: {//ajax验证。server result:{"valid",true or false} 向服务发送当前input name值，获得一个json数据。例表示正确：{"valid",true}
                            url: "jzBaseInfo/isExist",//验证地址
                            data:function(validator) {// 获取需要传送到后台的验证的数据
                                return {
                                    applyCode:$('#applyCode').val()
                                }
                            },
                            message: '申请编码已存在',//提示消息
                            delay :  500,//每输入一个字符，就发ajax请求，服务器压力还是太大，设置2秒发送一次ajax（默认输入一个字符，提交一次，服务器压力太大）
                            type: 'POST'//请求方式
                        }
                    }
                },
                salesman: {
                    message: '营销员姓名验证失败',
                    validators: {
                        notEmpty: {
                            message: '营销员姓名不能为空'
                        },
                        stringLength: {
                            min: 2,
                            max: 5,
                            message: '营销员姓名长度必须在2到5之间'
                        }
                    }
                },
                salesman: {
                    message: '营销员编码验证失败',
                    validators: {
                        notEmpty: {
                            message: '营销员编码不能为空'
                        },
                        stringLength: {
                            min: 2,
                            max: 30,
                            message: '营销员编码长度必须在2到30之间'
                        }
                    }
                },
                customerName:{
                    message: '客户姓名无效',
                    validators: {
                        stringLength: {
                            min: 2,
                            max: 5,
                            message: '客户姓名长度必须在2到5之间'
                        }
                    }
                },
                identityCode:{
                    message: '客户身份证号码无效',
                    validators: {
                        regexp: {
                            regexp: /^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,
                            message: '身份证号码格式错误'
                        }
                    }
                },
                contactNumber : {
                    message: '联系电话无效',
                    validators: {
                        regexp: {
                            regexp: /^1[3456789]\d{9}$/,
                            message: '手机号码格式错误'
                        }
                    }
                },
                jzFqQs:{
                    message: '分期期数无效',
                    validators: {
                        regexp: {
                            regexp: /^(0|[1-9][0-9]{1})$/,
                            message: '分期期数格式错误'
                        }
                    }
                },
                jzFqRate:{
                    message: '分期费率无效',
                    validators: {
                        regexp: {
                            regexp: /^[0-9]+(.[0-9]{1,2})?$/,
                            message: '分期费率格式错误'
                        }
                    }
                },
                jzFqMoney:{
                    message: '分期金额无效',
                    validators: {
                        regexp: {
                            regexp: /^[0-9]+(.[0-9]{1,2})?$/,
                            message: '分期金额格式错误'
                        }
                    }
                },
                jzSpMoney:{
                    message: '审批金额无效',
                    validators: {
                        notEmpty: {
                            message: '审批金额不能为空'
                        },
                        regexp: {
                            regexp: /^[0-9]+(.[0-9]{1,2})?$/,
                            message: '审批金额格式错误'
                        }
                    }
                },
                passDate:{
                    message: '通过时间无效',
                    validators: {
                        notEmpty: {
                            message: '通过时间不能为空'
                        }
                    }
                },
                cardNumber:{
                    message: '卡号无效',
                    validators: {
                        regexp: {
                            regexp: /^([1-9]{1})(\d{14}|\d{18})$/,
                            message: '卡号格式错误'
                        }
                    }
                },
                firstTeMoney:{
                    message: '一次调额金额无效',
                    validators: {
                        regexp: {
                            regexp: /^[0-9]+(.[0-9]{1,2})?$/,
                            message: '一次调额金额格式错误'
                        }
                    }
                },
                secondTeMoney:{
                    message: '二次调额金额无效',
                    validators: {
                        regexp: {
                            regexp: /^[0-9]+(.[0-9]{1,2})?$/,
                            message: '二次调额金额格式错误'
                        }
                    }
                },
                surplusMoney:{
                    message: '剩余可用金额无效',
                    validators: {
                        regexp: {
                            regexp: /^[0-9]+(.[0-9]{1,2})?$/,
                            message: '剩余可用金额格式错误'
                        }
                    }
                }
            }
        })

        // 绑定dialog的确定按钮的监听事件
        $("#btnOk",window.top.document).click(function() {
            // 此段是为防止需要点击两次按钮来实现验证的方法，若不添加此处的放行，那么我们将要点击两次确定按钮才可以提交验证
            var applyCode = $("#applyCode").val();
            // 判断当前的code又值，且当前不存在错误验证方可放开该字段的验证
            if(applyCode != null && applyCode != ""&&$("#applyCode").parent("div").find('.glyphicon-remove').length==0){
                $('#jzBaseInfoForm').bootstrapValidator('enableFieldValidators', 'applyCode', false);
            } else {
                $('#jzBaseInfoForm').bootstrapValidator('enableFieldValidators', 'applyCode', true);
            }
            var bootstrapValidator = $("#jzBaseInfoForm", window.top.document).data('bootstrapValidator');
            bootstrapValidator.validate();
            if(bootstrapValidator.isValid()){
                $.post($("#jzBaseInfoForm",window.top.document).attr('action'),$("#jzBaseInfoForm",window.top.document).serialize(),function(e){
                    if(e.result){
                        $('.modal-dialog', window.top.document).parent('div').remove()
                        $('body', window.top.document).find('.modal-backdrop').remove();
                        // jquery 调用刷新当前操作的table页面的refresh方法
                        $(window.parent.document).contents().find(".tab-pane.fade.active.in iframe")[0].contentWindow.doQuery();
                        window.Ewin.alert({message:e.msg});
                    }else{
                        window.Ewin.alert({message:e.msg});
                    }
                })
            }else{
                return false;
            }
        });

    })
    ]]>
</script>
</body>
</html>